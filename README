ファイルシステムの監視「inotify」を利用してリアルタイムにアクセス制御を試す

ほぼリアルタイムでアクセス拒否するシェルβ版を作ってみた。
処理内容は、シェルのコメントにも書いてあるけど、こんな感じ。

①Apacheのログファイルを監視して、拒否したいアクセスをしてきたIPアドレスを「iptables」に登録して、通信を拒否する。
②アクセス拒否IPを累積する※１
③アクセス拒否IP登録メールをroot宛に送信する


「拒否したいアクセス」は正規表現で記載しているので、追加や変更は下記の部分を修正する。

#アクセス拒否判定文字列:エージェント「ZmEu」でアクセスしてきて「HTTP 404」出したヤツのIP取得
chkStr='.+GET.+HTTP/1\.1" 404.+"ZmEu"'



注意：
β版なので、期待しない。
「iptables」にアクセス拒否を登録します。

使用条件：
ファイルの更新監視には「inotify」を使用しているので、inotifyがインストールされていること。
Debian、Ubuntuの場合、「apt-get install inotify-tools」でインストール！


詳細は下記を参照
http://brokendish.org/debian/1711/
http://brokendish.org/debian/1703/